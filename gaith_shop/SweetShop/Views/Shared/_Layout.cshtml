@using SweetShop.Models
@inject ShoppingCart _shoppingCart

<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - حلويات الاسمر </title>
    <script type="importmap"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Readex+Pro:wght@160..700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/SweetShop.styles.css" asp-append-version="true" />
</head>

<body>
    <header>
        <div class="top-header bg-light-blue text-dark border-bottom"
            style="padding-top: 9px; padding-bottom: 8px; font-size: 12px;">
            <div class="container-fluid d-flex justify-content-between align-items-center flex-wrap"
                style="padding-left: 120px; padding-right: 120px;">
                <!-- Left Side: Email & Phone -->
                <div class="d-flex align-items-center header-divider-group" style="gap: 10px;">
                    <span><i class="bi bi-envelope-fill text-primary-custom me-1"></i> البريد :
                        info@sweetshop.com </span>
                    <span><i class="bi bi-telephone-fill text-primary-custom me-1"></i> الهاتف :
                        <span dir="ltr">+962 79 123 4567</span></span>
                </div>

                <!-- Right Side: Language, Country, Currency -->
                <div class="d-flex align-items-center header-divider-group" style="gap: 10px;">
                    <span class="fs-custom">العربية</span>
                    <span class="d-flex align-items-center gap-1">
                        <span>الأردن</span>
                        <img src="https://flagcdn.com/w20/jo.png" alt="Jordan Flag" width="24">
                    </span>
                    <span class="text-primary-custom fs-custom">دينار أردني</span>
                </div>
            </div>
        </div>

        <!-- Main Header Section (Logo, Search, Actions) -->
        <div class="main-header d-flex justify-content-between align-items-center py-2 bg-white border-bottom">
            <div class="container-fluid d-flex justify-content-between align-items-center"
                style="padding-left: 100px; padding-right: 100px; padding-top: 8px; padding-bottom: 8px; font-size: 14px;">

                <!-- Right: Logo & Slogan -->
                <a asp-controller="Home" asp-action="Index"
                    class="d-flex align-items-center gap-3 text-decoration-none">
                    <!-- Default Logo & Slogan -->
                    <span class="default-logo d-flex align-items-center gap-3">
                        <img src="~/images/logo.png" alt="Sweet Shop Logo" style="height: 80px; border-radius: 20px;">
                        <h2 class="slogan-text m-0" style="color: #C7AE6A; font-weight: bold; font-size: 27px;"> حلويات
                            الاسمر </h2>
                    </span>

                    <!-- Sticky Logo (Hidden by default) -->
                    <img src="~/images/sticky-logo.png" alt="Sticky Logo" class="sticky-logo d-none"
                        style="height: 60px;">
                </a>

                <!-- Center: Search Bar -->
                <div class="w-50 mx-3">
                    <form asp-controller="Product" asp-action="Search" method="get"
                        class="d-flex justify-content-center">
                        <div class="input-group" style="max-width: 800px; width: 100%;">
                            <input name="q" class="form-control border-end-0 rounded-start" type="search"
                                placeholder="البحث..." aria-label="Search"
                                style="border-radius: 0 0.375rem 0.375rem 0; height: 50px; font-size: 1.1rem; padding: 0 1rem;">
                            <button class="btn btn-dark-blue rounded-end" type="submit"
                                style="border-radius: 0.375rem 0 0 0.375rem; width: 60px;">
                                <i class="bi bi-search text-white fs-5"></i>
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Left: Account & Cart -->
                <div class="d-flex align-items-center gap-4">

                    <!-- Account -->
                    <a asp-controller="Account" asp-action="Login"
                        class="d-flex align-items-center gap-2 text-dark text-decoration-none">
                        <span>حسابي</span>
                        <i class="bi bi-person fs-5"></i>
                    </a>

                    <!-- Divider -->
                    <div style="width: 1px; height: 24px; background-color: #C7AE6A;"></div>

                    <!-- Cart -->
                    <a href="#" data-bs-toggle="offcanvas" data-bs-target="#cartOffcanvas" onclick="loadCart()"
                        class="d-flex align-items-center gap-2 text-dark text-decoration-none position-relative">
                        <span>عربة التسوق</span>
                        <div class="position-relative">
                            <i class="bi bi-cart fs-5"></i>
                            <span id="cart-badge"
                                class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
                                style="font-size: 0.6rem; padding: 0.25em 0.4em;">
                                @_shoppingCart.GetShoppingCartTotalCount()
                            </span>
                        </div>
                    </a>
                </div>

                <!-- Sticky Header Center Logo -->
                <div class="sticky-center-logo d-none justify-content-center align-items-center position-absolute"
                    style="left: 50%; transform: translateX(-50%);">
                    <img src="~/images/theName.png" alt="حلويات عربية" style="height: 65px;">
                </div>

                <!-- Sticky Header Extras (Left Side) -->
                <div class="sticky-extras d-none align-items-center" style="gap: 35px;">
                    <!-- Language (العربية) -->
                    <a href="#" class="fw-bold text-decoration-none" style="color: #1A8CB0;">العربية</a>

                    <!-- Cart (التسوق) -->
                    <a href="#" class="position-relative" style="color: #1A8CB0;" data-bs-toggle="offcanvas"
                        data-bs-target="#cartOffcanvas" onclick="loadCart()">
                        <i class="bi bi-cart fs-5"></i>
                        <span id="sticky-cart-badge"
                            class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
                            style="font-size: 0.5rem; padding: 0.2em 0.35em;">
                            @_shoppingCart.GetShoppingCartTotalCount()
                        </span>
                    </a>

                    <!-- Search (البحث) -->
                    <a href="#" style="color: #1A8CB0;" data-bs-toggle="modal" data-bs-target="#searchModal">
                        <i class="bi bi-search fs-5"></i>
                    </a>

                    <!-- Contact (الأردن) -->
                    <a href="tel:+962791234567" style="color: #1A8CB0;"><i class="bi bi-telephone-fill fs-5"></i></a>
                </div>

                <!-- Sticky Header Right Side (Categories Dropdown) -->
                <div class="sticky-categories d-none align-items-center position-absolute" style="right: 80px;">
                    <div class="dropdown">
                        <button class="btn d-flex align-items-center gap-2 px-3 py-2"
                            style="background-color: #1A8CB0; color: white; border: none; border-radius: 5px;"
                            type="button" id="stickyCategoriesDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-list fs-5"></i>
                            <span>جميع الأصناف</span>
                        </button>
                        <ul class="dropdown-menu text-end" aria-labelledby="stickyCategoriesDropdown">
                            <li><a class="dropdown-item" asp-controller="Product" asp-action="List"
                                    asp-route-category="حلويات عربية">حلويات عربية</a></li>
                            <li><a class="dropdown-item" asp-controller="Product" asp-action="List"
                                    asp-route-category="كنافة">كنافة</a></li>
                            <li><a class="dropdown-item" asp-controller="Product" asp-action="List"
                                    asp-route-category="الحلويات الغربية">الحلويات الغربية</a></li>
                            <li><a class="dropdown-item" asp-controller="Product" asp-action="List"
                                    asp-route-category="الشوكلاتة والهدايا">الشوكلاتة والهدايا</a></li>
                            <li><a class="dropdown-item" asp-controller="Product" asp-action="List"
                                    asp-route-category="عبوات خاصة">عبوات خاصة</a></li>
                            <li><a class="dropdown-item" asp-controller="Product" asp-action="List"
                                    asp-route-category="بوظة">بوظة</a></li>
                        </ul>
                    </div>
                </div>

                <!-- Sticky Header Right Side (User Icon) -->
                <div class="sticky-user-icon d-none align-items-center position-absolute" style="right: 20px;">
                    <a asp-controller="Account" asp-action="Login"
                        class="d-flex align-items-center justify-content-center"
                        style="width: 45px; height: 45px; background-color: #1A8CB0; border-radius: 50%; text-decoration: none;">
                        <i class="bi bi-person-fill fs-4 text-white"></i>
                    </a>
                </div>

            </div>
        </div>


    </header>

    <!-- Search Modal -->
    <div class="modal fade" id="searchModal" tabindex="-1" aria-labelledby="searchModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header border-0 pb-0">
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form asp-controller="Product" asp-action="Search" method="get" class="d-flex">
                        <input name="q" class="form-control me-2" type="search" placeholder="ابحث عن منتج..."
                            aria-label="Search">
                        <button class="btn btn-outline-primary" type="submit">بحث</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Bar -->
    <nav class="navbar navbar-expand-lg nav-bar-custom border-bottom py-0" dir="rtl">
        <div class="container-fluid" style="padding-left: 80px; padding-right: 80px;">
            <!-- Mobile Toggler -->
            <!-- Mobile Toggler -->
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNavbar"
                aria-controls="mainNavbar" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <!-- All Categories Button (Visible on all screens or just desktop? User asked for logic but usually this is part of collapse or separate. I'll keep it outside collapse for visibility or inside. Standard is inside for mobile cleaning. Let's put it inside or alongside.) -->
            <!-- Keeping it visible as main action or collapsing it? Usually better to collapse on mobile to save space. -->

            <div class="collapse navbar-collapse mt-2 mt-lg-0" id="mainNavbar">
                <div class="d-flex flex-column flex-lg-row align-items-lg-center gap-3 w-100">

                    <!-- All Categories Dropdown -->
                    <div class="dropdown">
                        <button
                            class="btn all-categories-btn d-flex align-items-center gap-2 rounded-0 px-4 py-2 w-100 justify-content-center justify-content-lg-start"
                            type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                            <i class="bi bi-list fs-5"></i>
                            <span>جميع الأصناف</span>
                        </button>
                        <ul class="dropdown-menu text-end w-100" aria-labelledby="dropdownMenuButton1">
                            <li><a class="dropdown-item" asp-controller="Product" asp-action="List"
                                    asp-route-category="حلويات عربية">حلويات عربية</a></li>
                            <li><a class="dropdown-item" asp-controller="Product" asp-action="List"
                                    asp-route-category="كنافة">كنافة</a></li>
                            <li><a class="dropdown-item" asp-controller="Product" asp-action="List"
                                    asp-route-category="الحلويات الغربية">الحلويات الغربية</a></li>
                            <li><a class="dropdown-item" asp-controller="Product" asp-action="List"
                                    asp-route-category="الشوكلاتة والهدايا">الشوكلاتة والهدايا</a></li>
                            <li><a class="dropdown-item" asp-controller="Product" asp-action="List"
                                    asp-route-category="عبوات خاصة">عبوات خاصة</a></li>
                            <li><a class="dropdown-item" asp-controller="Product" asp-action="List"
                                    asp-route-category="بوظة">بوظة</a></li>
                        </ul>
                    </div>

                    <!-- Navigation Links -->
                    <ul
                        class="navbar-nav d-flex flex-column flex-lg-row align-items-center gap-4 flex-grow-1 justify-content-lg-between mb-2 mb-lg-0">
                        <!-- Right Group -->
                        <div class="d-flex flex-column flex-lg-row gap-2 gap-lg-3 align-items-center"
                            style="font-size:20px">
                            <li class="nav-item">
                                <a class="nav-link nav-link-custom text-dark" asp-controller="Product" asp-action="List"
                                    asp-route-category="حلويات عربية">حلويات عربية</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link nav-link-custom text-dark" asp-controller="Product" asp-action="List"
                                    asp-route-category="كنافة">كنافة</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link nav-link-custom text-dark" asp-controller="Product" asp-action="List"
                                    asp-route-category="الحلويات الغربية">الحلويات الغربية</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link nav-link-custom text-dark" asp-controller="Product" asp-action="List"
                                    asp-route-category="الشوكلاتة والهدايا">الشوكلاتة والهدايا</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link nav-link-custom text-dark" asp-controller="Product" asp-action="List"
                                    asp-route-category="عبوات خاصة">عبوات خاصة</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link nav-link-custom text-dark" asp-controller="Product" asp-action="List"
                                    asp-route-category="بوظة">بوظة</a>
                            </li>
                        </div>

                        <!-- Left Group -->
                        <div class="d-flex flex-column flex-lg-row gap-4 gap-lg-5 align-items-center">
                            <li class="nav-item">
                                <a class="nav-link nav-link-custom text-dark" asp-controller="Orders"
                                    asp-action="Create">طلبيات</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link nav-link-custom text-dark" asp-controller="Home"
                                    asp-action="Branches">فروعنا</a>
                            </li>
                            @if (User.IsInRole("Admin"))
                            {
                                    <li class="nav-item">
                                        <a class="nav-link d-flex align-items-center gap-1 fw-semibold"
                                           asp-controller="Admin" asp-action="Index"
                                           style="color:#1A8CB0;border:1px solid #1A8CB0;border-radius:8px;padding:4px 14px;">
                                            <i class="bi bi-shield-check"></i> لوحة التحكم
                                        </a>
                                    </li>
                            }
                        </div>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <!-- Side Cart Offcanvas -->
    <div class="offcanvas offcanvas-end cart-offcanvas-premium" tabindex="-1" id="cartOffcanvas"
        aria-labelledby="cartOffcanvasLabel">
        <div id="cart-offcanvas-content">
            <!-- Content loaded via AJAX -->
            <div class="d-flex justify-content-center align-items-center h-100">
                <div class="spinner-border text-primary" role="status">
                    <span class="visually-hidden">Loading...</span>
                </div>
            </div>
        </div>
    </div>
    <div class="container-fluid px-5">
        <main role="main" class="pb-3">
            @RenderBody()
        </main>
    </div>

    <partial name="_Footer" />
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    <script src="~/js/cart.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>

</html>
